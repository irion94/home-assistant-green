# Example automation for Strava Coach morning notifications
#
# This automation sends today's training suggestion as a notification
# at 07:30 every morning to your mobile device.
#
# Installation:
# 1. Copy this to your Home Assistant automations.yaml or
# 2. Add via the UI: Settings â†’ Automations â†’ Create Automation â†’ Edit in YAML

automation:
  - alias: "Strava Coach: Morning Training Suggestion"
    description: "Send daily training suggestion notification at 07:30"
    trigger:
      - platform: time
        at: "07:30:00"
    condition: []
    action:
      - service: notify.mobile_app_YOUR_DEVICE
        data:
          title: "ðŸš´ Today's Training"
          message: >
            {{ states('sensor.strava_coach_today_suggestion') }}

            {{ state_attr('sensor.strava_coach_today_suggestion', 'rationale_short') }}

            ðŸ“Š Readiness: {{ states('sensor.strava_coach_readiness') }}%
            ðŸ“ˆ Form: {{ states('sensor.strava_coach_form') }}
            ðŸ’ª Fitness: {{ state_attr('sensor.strava_coach_readiness', 'ctl') | round(1) }}
          data:
            # Optional: Add action buttons
            actions:
              - action: "URI"
                title: "View Details"
                uri: "/lovelace/strava-coach"
    mode: single

  - alias: "Strava Coach: Daily Sync"
    description: "Sync Strava data every morning at 07:00"
    trigger:
      - platform: time
        at: "07:00:00"
    condition: []
    action:
      - service: strava_coach.sync_now
    mode: single

# Alternative: Send to multiple notify targets
#
# - alias: "Strava Coach: Morning Suggestion (Multi-device)"
#   trigger:
#     - platform: time
#       at: "07:30:00"
#   action:
#     - service: notify.notify  # Default notify service (all devices)
#       data:
#         title: "ðŸš´ Today's Training"
#         message: >
#           {{ states('sensor.strava_coach_today_suggestion') }}
#
#           {{ state_attr('sensor.strava_coach_today_suggestion', 'rationale_short') }}
#
# Alternative: Persistent notification card
#
# - alias: "Strava Coach: Dashboard Notification"
#   trigger:
#     - platform: time
#       at: "07:30:00"
#   action:
#     - service: persistent_notification.create
#       data:
#         title: "Today's Training Suggestion"
#         message: >
#           **{{ states('sensor.strava_coach_today_suggestion') }}**
#
#           {{ state_attr('sensor.strava_coach_today_suggestion', 'rationale_short') }}
#
#           Readiness: {{ states('sensor.strava_coach_readiness') }}%
#           Form (TSB): {{ states('sensor.strava_coach_form') }}
#         notification_id: strava_coach_daily
